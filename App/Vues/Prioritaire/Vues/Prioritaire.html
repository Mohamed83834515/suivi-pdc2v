<section>
    <section ng-init="InitialiseActivite()">
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-inverse">
                    <div class="panel-heading">
                        <div class="panel-heading-btn">
                            <a href="javascript:;" title="Afficher" class="btn btn-xs btn-icon btn-circle btn-default"
                                data-click="panel-expand"><i class="fa fa-expand"></i></a>

                            <!-- <!- <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a> -> -->
                        </div>
                        <h4 class="panel-title text-uppercase">Suivi des activités
                            <label ng-if="versionsssss != null">
                                <label class="text-white f-w-700" ng-repeat="version in ListeVerion"
                                    ng-if="version.id_version_ptba == versionsssss">
                                    (PTBA {{ version.annee_ptba + '-' + version.version_ptba }})
                                </label>
                            </label>
                            <label ng-if="versionsssss == null">
                                <!-- {{VersionOne}} -->
                                <label class="text-white f-w-700" ng-repeat="version in ListeVerion"
                                    ng-if="version.id_version_ptba == VersionOne">
                                    (PTBA {{ version.annee_ptba + '-' + version.version_ptba }})
                                </label>
                            </label>
                        </h4>
                    </div>
                    <style>
                        .t-grey {
                            font-size: 18px !important;
                            font-weight: 500 !important;
                            color: white !important;
                        }
                    </style>
                    <div class="panel-body">
                        <div class="d-flex bd-highlight mb-3">
                            <div class="p-2 mr-auto bd-highlight d-flex">
                                <!-- <label for="" class="mr-2"> version PTBA </label>
                                <select class="form-control"
                                    ng-change="ChangeVersion(Version);getActiviteChange(Version);getTauxDecaisserByuserVersion(Version)"
                                    placeholder="Type de Piece" name="Version" ng-model="Version"
                                    required>
                                    <option value="{{Version}}" ng-if="Version == null" selected disabled>
                                        {{getLibelle()}}</option>
                                    <option ng-repeat="TypeBeneficiaire in ListeVerion"
                                        value="{{TypeBeneficiaire.id_version_ptba}}"
                                        ng-if="Version == null && TypeBeneficiaire.id_version_ptba != VersionOne">
                                        {{TypeBeneficiaire.date_validation + '|' + TypeBeneficiaire.version_ptba}}</option>
                                    <option ng-repeat="TypeBeneficiaire in ListeVerion"
                                        value="{{TypeBeneficiaire.id_version_ptba}}" ng-if="Version != null">
                                        {{TypeBeneficiaire.date_validation + '|' + TypeBeneficiaire.version_ptba}}</option>
                                </select> -->
                            </div>
                            <!-- <div class="p-2 mr-auto bd-highlight d-flex align-items-center">
                                <label for="" class="mr-2"> version PTBA </label>
                                <select class="form-control" ng-change="ChangeVersion(Version);getActiviteChange(Version)" id="selectElement" placeholder="Type de Piece" name="Version" ng-model="Version" required
                                        ng-options="TypeBeneficiaire.id_version_ptba as (TypeBeneficiaire.observation + '-' + TypeBeneficiaire.version_ptba) for TypeBeneficiaire in ListeVerion">
                                </select>
                            </div> -->
                            <div class="p-2 bd-highlight">

                                <a class="btn btn-sm btn-outline-success" type="button" data-click="panel-reload"
                                    ng-click="" title="Actualiser" href=""><i class="fa fa-refresh"></i></a>
                            </div>
                            <div class="p-2 bd-highlight">
                                <input class="form-control form-control-sm"
                                    ng-keyup="myFunction();updateNumeroAfficher()" id="numero" ng-model="numero"
                                    placeholder="recherche">
                            </div>
                        </div>
                        <!-- Button trigger modal -->


                        <!-- Modal -->

                        <table id="" class="table table-striped table-responsive table-bordered">
                            <thead>
                                <tr>
                                    <th width="100">Code activité</th>
                                    <th width="400">Intitulé Activité</th>
                                    <th width="380">Tâche</th>
                                    <th width="150"> Date début</th>
                                    <th width="150">Date fin</th>
                                    <th width="200">Sous tâches</th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr class="odd gradeX" ng-repeat="activite in ListeActivite|filter:numero">
                                    <td>{{activite.code_activite_ptba}}</td>
                                    <td>{{activite.intitule_activite_ptba}}</td>
                                    <td>
                                        {{activite.code_tache}}:{{activite.intitule_tache}} </td>
                                    <td>{{activite.date_debut | date:'dd/MM/yyyy'}}</td>
                                    <td>{{activite.date_fin | date:'dd/MM/yyyy'}} </td>
                                    <td>
                                        <label data-toggle="modal" style="cursor: pointer;color: #168e37  "
                                            data-target="#exampleModal1"
                                            ng-click="getSuiviActivite(activite.id_groupe_tache)">Ajouter</label>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header" style="background-color: #168e37 !important;">
                                        <h5 class="modal-title text-white" id="exampleModalLabel">
                                            <label class="text-white text-center" ng-repeat="activite in ListeActivite"
                                                ng-if="id_activite_ptba_1 === activite.id_groupe_tache">
                                                {{activite.code_activite_ptba}}: {{activite.intitule_activite_ptba}}
                                            </label>
                                        </h5>
                                        <button type="button" ng-click="InitialiseActivite()" class="close"
                                            data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <form name="FormMotif11" novalidate>
                                            <div class="row">
                                                <!-- Premier groupe de champs -->
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <!-- <label for="message-text" class="col-form-label">Réalisation {{Motif.CodeTache}}  <span
                                                                    style="color:red;"> *</span></label> -->
                                                        <input type="hidden" class="form-control"
                                                             name="Motif"
                                                            placeholder="Libelle" ng-model="Motif.IdTache"
                                                            ng-pattern="regexCote">
                                                    </div>
                                                </div>

                                            </div>

                                            <div class="row">

                                                <!-- Premier champ textarea : {{Motif.Difficultes}}-->
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="message-text"
                                                            class="col-form-label col-lg-3">Sous tâches<span
                                                                style="color:red;"> *</span></label>
                                                        <div class="col-lg-9">
                                                            <textarea class="form-control" name="tache"
                                                                placeholder="Tâches" ng-model="Motif.tache"
                                                                ng-pattern="regexCote" required></textarea>
                                                            <span style="color:red;"
                                                                ng-show="FormMotif11.tache.$touched && FormMotif11.tache.$invalid">Champ
                                                                obligatoire ou caractère invalide
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="message-text" class="col-form-label col-lg-3">Date
                                                            prévue <span style="color:red;"> *</span></label>
                                                        <div class="col-lg-9">
                                                            <input class="form-control" ng-model="Motif.Delai"
                                                                name="Delai" type="date" required
                                                                ng-model-options="{ 'timezone': 'UTC', 'format': 'yyyy-MM-dd' }">
                                                            <span style="color:red;"
                                                                ng-show="FormMotif11.Delai.$touched && FormMotif11.Delai.$invalid">Champ
                                                                obligatoire ou caractère invalide
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="message-text"
                                                            class="col-form-label col-lg-3">Responsable associé<span
                                                                style="color:red;"> *</span></label>
                                                        <div class="col-lg-9">
                                                            <select class="form-control" style="width: 350px;" id="selectElement1" name="Responsable"
                                                                ng-model="Motif.Responsable" required multiple>
                                                                </option>
                                                                <option ng-repeat="activite in ListeActivite1"
                                                                    value="{{activite.N}}">{{activite.nom+ " "
                                                                    +activite.prenom}}</option>
                                                            </select>
                                                            <span style="color:red;"
                                                                ng-show="FormMotif11.Responsable.$touched && FormMotif11.Responsable.$invalid">Champ
                                                                obligatoire ou caractère invalide</span>
                                                        </div>
                                                        </span>
                                                    </div>
                                                </div>
                                                <!-- Deuxième champ textarea  ng-disabled="FormMotif11.$invalid"-->

                                            </div>


                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button name="Valider" value="Valider" ng-click="ValiderPlanification(Motif.IdTache)"
                                            class="btn" style="background-color: #168e37;color: white;" type="submit">
                                            <i class="fa fa-fw fa-lg fa-check-circle"></i>Valider
                                        </button>

                                        <button data-toggle="modal" data-target="#exampleModal1" class="btn btn-danger"
                                            data-dismiss="modal" aria-label="Close">
                                            <i class="fa fa-fw fa-lg fa-times-circle"></i><span
                                                aria-hidden="true">Annuler</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog"
                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-lg" role="document">
                                <div class="modal-content">
                                    <div class="modal-header"
                                        style="background-color:#168E37; color: white !important;">
                                        <h5 class="modal-title" id="exampleModalLabel">
                                            <label class="text-white text-center" ng-repeat="activite in ListeActivite"
                                                ng-if="id_activite_ptba_1 === activite.id_groupe_tache">
                                                {{activite.code_activite_ptba}}: {{activite.intitule_activite_ptba}}
                                            </label>
                                        </h5>
                                        <!-- && showbutton1(id_activite_ptba_1) === 2  -->
                                        <a href=""
                                            style="color: white;background-color: black; font-size: 20px; padding: 5px"
                                            ng-click="Motif.IdTache = id_activite_ptba_1" class="btn-sm btn col-lg-2"
                                            data-toggle="modal" data-target="#exampleModal" data-dismiss="modal">
                                            <i class="fas fa-plus-circle"> Nouveau</i>
                                        </a>
                                    </div>
                                    <div class="modal-body">
                                        <table id="" class="table table-striped table-responsive table-bordered">
                                            <thead>
                                                <tr>
                                                    <!-- <th>Code </th> -->
                                                    <th width="400">Sous tâches</th>
                                                    <th width="150">Responsables</th>
                                                    <th width="200">Date prévue </th>
                                                    <th width="150">Action</th>

                                                </tr>
                                            </thead>
                                            <tbody>

                                                <tr class="odd gradeX" ng-repeat="Motif in suividata">
                                                    <!-- <td>{{Motif.code_suivi}} {{Motif.etat}}</td> -->
                                                    <td width="300">
                                                        <label for="" class="text-dark">{{Motif.sous_activite}}
                                                           </label>
                                                    </td>
                                                    <td>
                                                        {{ getResponsableNoms(Motif.numero_avenant) }}
                                                    </td>
                                                    <td>
                                                        {{Motif.date_avenant | date:'dd/MM/yyyy'}}
                                                    </td>
                                                    <td>
                                                        <a href="" ng-click="getPlanificationById(Motif.id_suivi)"
                                                            title="Modifier" data-toggle="modal"
                                                            data-target="#exampleModal3" data-dismiss="modal">
                                                            <i class="fa fa-pencil-square-o mr-2"
                                                                style="color:#231dd9;font-size: 20px;"></i>
                                                        </a>
                                                        <a href="" ng-click="ValideDeleteById(Motif.id_suivi,id_activite_ptba_1)"
                                                            title="Supprimer">
                                                            <i class="fas fa-trash-alt mr-2"
                                                                style="color:#cf0d0d;font-size: 20px;"></i>
                                                        </a>
                                                        <!-- <div ng-repeat="activite in ListeActivite" ng-if="activite.responsable === nomadmin || activite.executant === nomadmin && Motif.id_activite_ptba === activite.id_ptba"> -->
                                                        <!-- <div ng-if="Motif.etat != 1 && Motif.etat != 2">

                                                            <label for="" ng-repeat="activite in ListeActivite"
                                                                ng-if="activite.id_ptba === Motif.id_activite_ptba">
                                                                <label for="" ng-if="activite.responsable === nomadmin">
                                                                    <a href=""
                                                                        ng-click="getAlertValidationTache(Motif.id_suivi,Motif.id_activite_ptba,1)"
                                                                        title="Valider"> <i
                                                                            class="fas fa-check-circle fa-2x"></i>
                                                                    </a>
                                                                </label>
                                                            </label>
                                                        </div>
                                                        <div ng-if="Motif.etat == 1">
                                                            <label>
                                                                <i class="fas fa-check mr-2"
                                                                    style="color:#168E37;font-size: 20px;"
                                                                    aria-hidden="true"> validée
                                                                </i>
                                                            </label>
                                                            <label for="" ng-repeat="activite in ListeActivite"
                                                                ng-if="activite.id_ptba === Motif.id_activite_ptba">
                                                                <label for="" ng-if="activite.responsable === nomadmin">
                                                                    <a href="" style="color: #cf0d0d;"
                                                                        ng-click="getAlertValidationTache(Motif.id_suivi,Motif.id_activite_ptba,0)"
                                                                        title="Annuler"> <i
                                                                            class="fas fa-times fa-2x"></i>
                                                                    </a>
                                                                </label>
                                                            </label>
                                                        </div> -->
                                                        <div ng-if="Motif.etat == 2">
                                                            <label>
                                                                <i class="fas fa-check mr-2"
                                                                    style="color:#168E37;font-size: 20px;"
                                                                    aria-hidden="true">
                                                                    validée par le SSE
                                                                </i>
                                                            </label>
                                                        </div>

                                                    </td>

                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="modal-footer">
                                        <!-- <button type="button" class="btn btn-seocndary"
                                            data-dismiss="modal">Close</button> -->
                                        <button type="button" style="background-color: #168E37; color: white;"
                                            data-dismiss="modal" class="btn"> <i class="fas fa-close"> </i>
                                            Fermer</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal fade" id="exampleModal3" tabindex="-1" role="dialog"
                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header" style="background-color: #168e37 !important;">
                                        <h5 class="modal-title text-white" id="exampleModalLabel">
                                            <label class="text-white text-center" ng-repeat="activite in ListeActivite"
                                                ng-if="id_activite_ptba_1 === activite.id_groupe_tache">
                                                {{activite.code_activite_ptba}}: {{activite.intitule_activite_ptba}}
                                            </label>
                                        </h5>
                                        <button type="button" ng-click="InitialiseActivite()" class="close"
                                            data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <form name="FormMotif11" novalidate>
                                            <div class="row">
                                                <!-- Premier groupe de champs -->
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <!-- <label for="message-text" class="col-form-label">Réalisation {{Motif.CodeTache}}  <span
                                                                    style="color:red;"> *</span></label> -->
                                                        <input type="hidden" class="form-control"
                                                            ng-value="{{id_activite_ptba_1}}" name="Motif"
                                                            placeholder="Libelle" ng-model="Motif.IdTache"
                                                            ng-pattern="regexCote">
                                                    </div>
                                                </div>

                                            </div>

                                            <div class="row">
                                                <!-- <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="message-text" class="col-form-label col-lg-3">Sous
                                                            tâches <span style="color:red;"> *</span></label>
                                                        <div class="col-lg-9">
                                                            <select class="form-control" name="activite"
                                                                ng-model="Motif.activite" required>

                                                                <option value="" disabled selected>-- choisir --
                                                                </option>
                                                                <option ng-repeat="activite in ListeSousActivite"
                                                                    value="{{activite.id_suivi}}">
                                                                    {{activite.etat_avancement}}</option>
                                                            </select>
                                                            <span style="color:red;"
                                                                ng-show="FormMotif2.activite.$touched && FormMotif2.activite.$invalid">Champ
                                                                obligatoire ou caractère invalide</span>
                                                        </div>
                                                    </div>

                                                </div> -->

                                                <!-- Premier champ textarea : {{Motif.Difficultes}}-->
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="message-text"
                                                            class="col-form-label col-lg-3">Sous tâches<span
                                                                style="color:red;"> *</span></label>
                                                        <div class="col-lg-9">
                                                            <textarea class="form-control" name="tache"
                                                                placeholder="Tâches" ng-model="Motif.tache"
                                                                ng-pattern="regexCote" required></textarea>
                                                            <span style="color:red;"
                                                                ng-show="FormMotif11.tache.$touched && FormMotif11.tache.$invalid">Champ
                                                                obligatoire ou caractère invalide
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="message-text" class="col-form-label col-lg-3">Date
                                                            prévue <span style="color:red;"> *</span></label>
                                                        <div class="col-lg-9">
                                                            <input class="form-control" ng-model="Motif.Delai"
                                                                name="Delai" type="date" required
                                                                ng-model-options="{ 'timezone': 'UTC', 'format': 'yyyy-MM-dd' }">
                                                            <span style="color:red;"
                                                                ng-show="FormMotif11.Delai.$touched && FormMotif11.Delai.$invalid">Champ
                                                                obligatoire ou caractère invalide
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="message-text"
                                                            class="col-form-label col-lg-3">Responsable associé<span
                                                                style="color:red;"> *</span></label>
                                                        <div class="col-lg-9">
                                                            <select class="form-control" id="selectElement3" style="width: 350px;" name="Responsable"
                                                                ng-model="Motif.Responsable" required multiple>
                                                                </option>
                                                                <option ng-repeat="activite in ListeActivite1"
                                                                    value="{{activite.N}}">{{activite.nom+ " "
                                                                    +activite.prenom}}</option>
                                                            </select>
                                                            <!-- <span style="color:red;"
                                                                ng-show="FormMotif11.Responsable.$touched && FormMotif11.Responsable.$invalid">Champ
                                                                obligatoire ou caractère invalide</span> -->
                                                        </div>
                                                        </span>
                                                    </div>
                                                </div>
                                                <!-- Deuxième champ textarea  ng-disabled="FormMotif11.$invalid"-->

                                            </div>


                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button name="Valider" value="Valider" ng-click="ValideUpdatePlanification(id_activite_ptba_1)"
                                            class="btn" style="background-color: #168e37;color: white;" type="submit">
                                            <i class="fa fa-fw fa-lg fa-check-circle"></i>Valider
                                        </button>

                                        <button data-toggle="modal" data-target="#exampleModal1" class="btn btn-danger"
                                            data-dismiss="modal" aria-label="Close">
                                            <i class="fa fa-fw fa-lg fa-times-circle"></i><span
                                                aria-hidden="true">Annuler</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
    </section>
</section>